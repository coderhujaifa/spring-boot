<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Admin Dashboard</title>

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

    <style>
        body {
            background: #f4f6f9;
        }
        .card-shadow {
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        .chat-box {
            background: #ffffff;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 15px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }
        .user-tag {
            background: #0d6efd;
            color: white;
            padding: 3px 8px;
            border-radius: 6px;
            font-size: 12px;
        }
        .role-tag {
            background: #198754;
            color: white;
            padding: 2px 6px;
            border-radius: 5px;
            font-size: 12px;
            margin-left: 5px;
        }
    </style>
</head>

<body>

<!-- NAVBAR -->
<nav class="navbar navbar-dark bg-dark px-4 mb-4">
    <h3 class="text-white">ðŸ›  Admin Dashboard</h3>
    <a th:href="@{/logout}" class="btn btn-danger btn-sm">Logout</a>
</nav>

<div class="container">

    <!-- USERS LIST -->
    <div class="card card-shadow mb-4 p-4">
        <h4 class="mb-3">ðŸ‘¤ Registered Users</h4>
        <ul class="list-group">
            <li class="list-group-item d-flex justify-content-between align-items-center"
                th:each="u : ${users}">
                <span>
                    <span class="fw-bold" th:text="${u.username}"></span>
                </span>

                <span>
                    <span class="role-tag"
                          th:each="r : ${u.roles}"
                          th:text="${r}"></span>
                </span>
            </li>
        </ul>
    </div>

    <!-- CHAT HISTORY -->
    <div class="card card-shadow p-4">
        <h4 class="mb-3">ðŸ’¬ All User Chats</h4>

        <div th:each="c : ${chats}" class="chat-box">

            <!-- USER + DATE -->
            <p class="mb-1">
                <span class="user-tag" th:text="${c.user.username}"></span>
                <span class="text-muted" style="font-size: 13px;"
                      th:text="${#dates.format(c.createdAt,'dd-MMM-yyyy HH:mm')}"></span>
            </p>

            <!-- USER MESSAGE -->
            <p class="mb-1"><strong>Q:</strong>
                <span th:text="${c.userMessage}"></span>
            </p>

            <!-- AI RESPONSE -->
            <p class="mb-1"><strong>A:</strong>
                <span th:text="${c.aiResponse}"></span>
            </p>

        </div>
    </div>

</div>

</body>
</html>
